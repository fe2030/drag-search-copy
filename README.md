# Drag search&copy

Drag search&copy は、テキストをドラッグ＆ドロップするだけで「検索」や「コピー」を素早く行える、軽量な Chrome 拡張機能です。
Manifest V3 に準拠し、シンプルかつ高速に動作します。

## 機能

テキストを選択し、ドラッグしてドロップする方向に応じてアクションを実行します。
**設定画面から各方向に割り当てる機能をカスタマイズできます。**

### デフォルト設定

#### 通常のドラッグ
*   **上 (Up):** Google 検索
*   **下 (Down):** X (Twitter) 検索
*   **左 (Left):** YouTube 検索
*   **右 (Right):** テキストをクリップボードにコピー（「COPY」ポップアップ表示）

#### 大きくドラッグ（80px以上）
*   **上 (Up):** なし
*   **下 (Down):** なし
*   **左 (Left):** なし
*   **右 (Right):** なし

> **Note:** 大きくドラッグ（80px以上移動）すると、通常のドラッグとは別のアクションを実行できます。設定画面からカスタマイズ可能です。

### 選択可能な機能一覧

| カテゴリ | 機能 | 説明 |
|----------|------|------|
| - | なし | 何もしない |
| 検索 | Google 検索 | Google で検索 |
| 検索 | YouTube 検索 | YouTube で検索 |
| 検索 | X (Twitter) 検索 | X (Twitter) で検索 |
| 検索 | 楽天検索 | 楽天市場で検索 |
| 検索 | Amazon 検索 | Amazon.co.jp で検索 |
| 検索 | Google マップ | Google マップで検索 |
| 翻訳 | DeepL 翻訳 | DeepL で翻訳（英→日） |
| 翻訳 | Google 翻訳 | Google 翻訳で翻訳（自動検出→日） |
| AI | ChatGPT | ChatGPT を開いてテキストを入力欄に自動入力 |
| AI | Claude | Claude を開いてテキストを入力欄に自動入力 |
| AI | Gemini | Gemini を開いてテキストを入力欄に自動入力 |
| その他 | クリップボードにコピー | テキストをコピー |

> **Note:** AI 機能（ChatGPT、Claude、Gemini）は、ページを開いた後にテキストを入力欄に自動入力しますが、送信は行いません。

## インストール方法

この拡張機能は現在ストアで公開されていないため、以下の手順でデベロッパーモードからインストールしてください。

1.  このリポジトリのコードをローカルのフォルダに保存します。
2.  Chrome ブラウザを開き、アドレスバーに `chrome://extensions/` と入力して移動します。
3.  右上の「デベロッパーモード」スイッチをオンにします。
4.  「パッケージ化されていない拡張機能を読み込む」ボタンをクリックします。
5.  コードを保存したフォルダ（`manifest.json` があるフォルダ）を選択します。

## 使い方

1.  ウェブページ上の任意のテキストを選択します。
2.  選択したテキストをマウスでドラッグします。
3.  検索またはコピーしたい方向（上下左右）にマウスを動かしてドロップします。
    - **通常のドラッグ:** 少し動かすだけで発動
    - **大きくドラッグ:** 80px以上動かすと別のアクションが発動

### 設定の変更

1.  `chrome://extensions/` を開きます。
2.  「Drag search&copy」の「詳細」をクリックします。
3.  「拡張機能のオプション」をクリックします。
4.  各方向に割り当てる機能を選択し、「保存」をクリックします。

### 誤クリック防止機能

リンクやボタンをクリックしようとした際に、わずかなマウスのズレで拡張機能が反応してしまう問題を防ぐため、以下の対策が実装されています。

*   **テキスト選択がない状態**でリンクやボタンからドラッグを開始した場合、**150ミリ秒以上**ドラッグを続けないと反応しません。
*   テキストを選択してからドラッグする場合は、この制限は適用されません。

## 技術仕様

*   **Manifest Version:** 3
*   **Permissions:**
    *   `tabs`: 新しいタブでの検索結果表示に使用
    *   `storage`: 設定保存用
    *   `scripting`: AI サービスへの自動入力スクリプト注入用
    *   `clipboardWrite`: テキストのコピー機能に使用
*   **Host Permissions:** 全ての URL (`http://*/*`, `https://*/*`) で動作

## 開発者向け情報

### ファイル構成

*   `manifest.json`: 拡張機能の設定ファイル
*   `service-worker.js`: バックグラウンド処理（タブ作成、URL生成、AI自動入力）
*   `superdrag.js`: コンテンツスクリプト（ドラッグ＆ドロップのイベントハンドリング、DOM操作）
*   `options.html`: 設定画面のUI
*   `options.js`: 設定画面のロジック（設定の読み込み・保存）

### 動作ロジック

*   **Content Script (`superdrag.js`):** ページ内の全要素にドラッグイベントリスナーを付与し、ドラッグ方向と距離を判定します。`chrome.storage.sync` から設定を読み込み、方向と距離（通常/大きく）に応じた機能を実行します。
*   **Service Worker (`service-worker.js`):** Content Script からのメッセージを受け取り、指定された検索エンジンの URL を生成して新しいタブを開きます。AI サービスの場合は、タブを開いた後にスクリプトを注入してテキストを自動入力します。
*   **Options Page (`options.html`, `options.js`):** ユーザーが各方向（通常/大きく）に割り当てる機能を設定できる画面を提供します。

### ドラッグ距離の判定

| 距離 | 判定 |
|------|------|
| 0〜3px | 方向判定不可（何もしない） |
| 4〜79px | 通常のドラッグ |
| 80px以上 | 大きくドラッグ |

## ライセンス

MIT License
